name: 'Upload Coverage'
description: 'Used to upload coverage data to CodeScene'
inputs:
  cs-token:
    required: true
  format:
    required: true
  metric:
    required: true
  file:
    required: true
runs:
  using: "composite"
  steps:
    - name: Install cs tool
      shell: pwsh
      run: curl https://downloads.codescene.io/enterprise/cli/install-cs-coverage-tool.sh | bash -s -- -y
      
    - name: Add ~/.local/bin to PATH
      shell: pwsh
      run: |
        "$HOME\.local\bin" | Out-File -FilePath $env:GITHUB_PATH -Encoding utf8 -Append
        
    - name: Upload coverage data to CodeScene
      shell: pwsh
      run: |
        cs-coverage upload `
        --format ${{ inputs.format }} `
        --metric ${{ inputs.metric }} `
        ${{ inputs.file }}
      env:
        CS_ACCESS_TOKEN: ${{ inputs.cs-token }}
